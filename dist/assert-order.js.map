{"version":3,"sources":["webpack:///webpack/bootstrap 45a29c2bb49f408c0ccd","webpack:////assert-order/assertOrder.ts","webpack:////assert-order/index.ts"],"names":[],"mappings":"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","file":"assert-order.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 45a29c2bb49f408c0ccd","export interface Steps {\n  once?: number[]\n  some?: number[]\n  all?: number[]\n}\n\nexport class AssertOrder {\n  private static alias = {\n    step: 'once',\n    any: 'once'\n  }\n  private static reverseAlias = {\n    once: ['step'],\n    some: [],\n    all: []\n  }\n\n  /**\n   * Gets what is the next expecting step.\n   * If the current step is `some(n)`, this reflects the step after `some(n)`\n   */\n  public get next() { return this.nextStep }\n  private nextStep: number\n  private possibleMoves: Steps\n  private miniSteps = 0\n  private targetMiniSteps: number | undefined\n  constructor(public plannedSteps?: number, initStep = 0) {\n    this.nextStep = initStep\n    this.possibleMoves = {\n      once: [initStep],\n      some: [initStep],\n      all: [initStep]\n    }\n  }\n\n  /**\n   * Verify all planned steps are executed.\n   * @param timeout If specified, will return a promise that resolve after the specified time (in milliseconds) or rejected if failed.\n   */\n  end(timeout: number): Promise<never>\n  end(): void\n  end(timeout?: number) {\n    const check = (() => {\n      return this.plannedSteps === undefined || this.nextStep === this.plannedSteps\n    })\n    const getErrorMsg = () => `Planned ${this.plannedSteps} steps but executed ${this.nextStep} steps`\n\n    if (timeout) {\n      return new Promise((resolve, reject) => {\n        setTimeout(() => {\n          if (check()) {\n            resolve()\n          }\n          else {\n            reject(new Error(getErrorMsg()))\n          }\n        }, timeout);\n      })\n    }\n\n    if (!check()) {\n      throw new Error(getErrorMsg())\n    }\n  }\n\n  step(step: number) {\n    if (this.isValidStep('step', [step])) {\n      this.moveNext()\n      return this.nextStep++\n    }\n    else {\n      throw new Error(this.getErrorMessage('step', step))\n    }\n  }\n\n  /**\n   * Assert the specified step will run once.\n   */\n  once(step: number) {\n    // this.validate('once', [step], 1)\n    if (this.isValidStep('once', [step])) {\n      this.moveNext()\n      return this.nextStep++\n    }\n    else {\n      throw new Error(this.getErrorMessage('once', step))\n    }\n  }\n\n  /**\n   * Assert this place will be called during any of the specified steps.\n   * @returns the step it is being called right now.\n   */\n  any(...anySteps: number[]) {\n    if (this.isValidStep('any', anySteps)) {\n      this.moveNext()\n      return this.nextStep++\n    }\n    else {\n      throw new Error(this.getErrorMessage('any', ...anySteps))\n    }\n  }\n\n  /**\n   * Assert the specified step will be reached at least once.\n   * @returns how many times this step has occured.\n   */\n  some(step: number) {\n    if (this.isValidStep('some', [step])) {\n      if (step === this.nextStep) {\n        this.moveNext({\n          once: [step + 1],\n          some: [step, step + 1],\n          all: [step + 1]\n        })\n        this.miniSteps = 0\n        this.nextStep++\n      }\n\n      return ++this.miniSteps\n    }\n    else {\n      throw new Error(this.getErrorMessage('some', step))\n    }\n  }\n\n  /**\n   * Assert the specified step will be reached x times.\n   * @returns how many times this step has occured.\n   */\n  all(step: number, plan: number) {\n    if (plan <= 0) {\n      throw new Error(`${plan} is not a valid 'plan' value.`)\n    }\n    if (this.targetMiniSteps && this.targetMiniSteps !== plan) {\n      throw new Error(`The plan count (${plan}) does not match with previous value (${this.targetMiniSteps}).`)\n    }\n\n    if (this.isValidStep('all', [step], plan)) {\n      if (this.targetMiniSteps === undefined) {\n        this.targetMiniSteps = plan\n        this.miniSteps = 0\n        this.moveNext({\n          all: [step]\n        })\n      }\n\n      this.miniSteps++\n      if (plan === this.miniSteps) {\n        this.moveNext()\n        this.nextStep++\n        this.targetMiniSteps = undefined\n      }\n      return this.miniSteps\n    }\n    else {\n      throw new Error(this.getErrorMessage('all', step))\n    }\n  }\n\n  private isValidStep(fnName: string, steps: number[], count?: number) {\n    // console.log(`${fnName}(${steps}${count ? ',' + count : ''}), c: ${this.currentStep}, m: ${this.miniSteps}`, this.possibleMoves)\n    const id = AssertOrder.alias[fnName] || fnName\n    const step = steps.find(s => this.possibleMoves[id] && this.possibleMoves[id].some(x => x === s))\n    return (!count || this.miniSteps <= count) && step !== undefined\n  }\n  private moveNext(nextMoves: Steps = {\n    once: [this.nextStep + 1],\n    some: [this.nextStep + 1],\n    all: [this.nextStep + 1]\n  }) {\n    this.possibleMoves = nextMoves\n  }\n\n  private getErrorMessage(calledFn: string, ...calledSteps: number[]) {\n    const should: string[] = []\n    for (let key in this.possibleMoves) {\n      should.push(...([key, ...AssertOrder.reverseAlias[key]].map(name =>\n        `'${name}(${this.possibleMoves[key].join('|')})'`\n      )))\n    }\n\n    return `Expecting ${should.join(', ')}, but received '${calledFn}(${calledSteps.join(',')})'`\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// /assert-order/assertOrder.ts","import { AssertOrder } from './assertOrder'\nexport default AssertOrder\n\n\n\n// WEBPACK FOOTER //\n// /assert-order/index.ts"],"sourceRoot":""}